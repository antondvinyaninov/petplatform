import { useState } from 'react';
import PetTimeline from './PetTimeline';
import PetGeneralInfo from './PetGeneralInfo';
import PetIdentification from './PetIdentification';
import PetHealth from './PetHealth';

interface PetTabsProps {
  isEditing: boolean;
  pet: any;
  editData: any;
  setEditData: (data: any) => void;
  breeds: any[];
  breedSearch: string;
  setBreedSearch: (search: string) => void;
  showBreedDropdown: boolean;
  setShowBreedDropdown: (show: boolean) => void;
  birthDateType: 'exact' | 'approximate';
  setBirthDateType: (type: 'exact' | 'approximate') => void;
  calculateBirthDate: (years: number, months: number) => void;
  age: { years: number; months: number } | null;
}

type TabType = 'timeline' | 'general' | 'identification' | 'health' | 'system';

export default function PetTabs({
  isEditing,
  pet,
  editData,
  setEditData,
  breeds,
  breedSearch,
  setBreedSearch,
  showBreedDropdown,
  setShowBreedDropdown,
  birthDateType,
  setBirthDateType,
  calculateBirthDate,
  age,
}: PetTabsProps) {
  const [activeTab, setActiveTab] = useState<TabType>('timeline');

  const tabs = [
    { id: 'timeline' as TabType, label: '–•—Ä–æ–Ω–æ–ª–æ–≥–∏—è', icon: 'üìÖ' },
    { id: 'general' as TabType, label: '–û–±—â–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è', icon: 'üìã' },
    { id: 'identification' as TabType, label: '–ò–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è', icon: 'üè∑Ô∏è' },
    { id: 'health' as TabType, label: '–ó–¥–æ—Ä–æ–≤—å–µ', icon: 'üè•' },
    { id: 'system' as TabType, label: '–°–∏—Å—Ç–µ–º–∞', icon: '‚öôÔ∏è' },
  ];

  return (
    <div>
      {/* –¢–∞–±—ã */}
      <div className="bg-white rounded-t-lg shadow border-b">
        <div className="flex overflow-x-auto">
          {tabs.map((tab) => (
            <button
              key={tab.id}
              onClick={() => setActiveTab(tab.id)}
              className={`
                flex items-center gap-2 px-6 py-4 font-medium transition-colors whitespace-nowrap
                ${activeTab === tab.id
                  ? 'text-blue-600 border-b-2 border-blue-600 bg-blue-50'
                  : 'text-gray-600 hover:text-gray-900 hover:bg-gray-50'
                }
              `}
            >
              <span className="text-xl">{tab.icon}</span>
              <span>{tab.label}</span>
            </button>
          ))}
        </div>
      </div>

      {/* –ö–æ–Ω—Ç–µ–Ω—Ç —Ç–∞–±–æ–≤ */}
      <div className="bg-white rounded-b-lg shadow p-6">
        {activeTab === 'timeline' && (
          <PetTimeline petId={pet.id} pet={pet} />
        )}

        {activeTab === 'general' && (
          <PetGeneralInfo
            isEditing={isEditing}
            pet={pet}
            editData={editData}
            setEditData={setEditData}
            breeds={breeds}
            breedSearch={breedSearch}
            setBreedSearch={setBreedSearch}
            showBreedDropdown={showBreedDropdown}
            setShowBreedDropdown={setShowBreedDropdown}
            age={age}
          />
        )}

        {activeTab === 'identification' && (
          <PetIdentification
            isEditing={isEditing}
            pet={pet}
            editData={editData}
            setEditData={setEditData}
          />
        )}

        {activeTab === 'health' && (
          <PetHealth
            isEditing={isEditing}
            pet={pet}
            editData={editData}
            setEditData={setEditData}
          />
        )}

        {activeTab === 'system' && (
          <div className="space-y-3">
            <div>
              <label className="block text-xs font-medium text-gray-500 mb-1">ID –ø–∏—Ç–æ–º—Ü–∞</label>
              <p className="text-sm text-gray-900 font-mono bg-gray-50 p-2 rounded">#{pet.id}</p>
            </div>

            <div>
              <label className="block text-xs font-medium text-gray-500 mb-1">–î–∞—Ç–∞ —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏</label>
              <p className="text-sm text-gray-900 bg-gray-50 p-2 rounded">
                {new Date(pet.created_at).toLocaleDateString('ru-RU', {
                  year: 'numeric',
                  month: 'long',
                  day: 'numeric',
                  hour: '2-digit',
                  minute: '2-digit'
                })}
              </p>
            </div>

            {pet.species_id && (
              <div>
                <label className="block text-xs font-medium text-gray-500 mb-1">ID –≤–∏–¥–∞</label>
                <p className="text-sm text-gray-900 font-mono bg-gray-50 p-2 rounded">{pet.species_id}</p>
              </div>
            )}

            {pet.breed_id && (
              <div>
                <label className="block text-xs font-medium text-gray-500 mb-1">ID –ø–æ—Ä–æ–¥—ã</label>
                <p className="text-sm text-gray-900 font-mono bg-gray-50 p-2 rounded">{pet.breed_id}</p>
              </div>
            )}
          </div>
        )}
      </div>
    </div>
  );
}
